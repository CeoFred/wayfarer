{"version":3,"sources":["../../app/middlewares/auth_check.js"],"names":["jwt","require","_response","module","exports","req","res","next","rtoken","body","token","param","headers","authorization","split","decoded","verify","usertoken","decode","err","status","json","error"],"mappings":";;;;;;;;;;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB,C,CACA;;;AACA,IAAMC,SAAS,GAAGD,OAAO,CAAC,qBAAD,CAAzB;;AAEAE,MAAM,CAACC,OAAP,GAAiB,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACnC,MAAIC,MAAJ;;AACA,MAAIH,GAAG,CAACI,IAAJ,CAASC,KAAb,EAAoB;AAAA,mCACFL,GAAG,CAACI,IADF;AAAA,QACXC,KADW;;AAElBF,IAAAA,MAAM,GAAGE,KAAT;AACD,GAHD,MAGO,IAAIL,GAAG,CAACM,KAAJ,CAAUD,KAAd,EAAqB;AAAA,oCACVJ,GAAG,CAACK,KADM;AAAA,QACnBD,MADmB;;AAE1BF,IAAAA,MAAM,GAAGE,MAAT;AACD,GAHM,MAGA,IAAIL,GAAG,CAACO,OAAJ,CAAYC,aAAhB,EAA+B;AACpC;AACAL,IAAAA,MAAM,GAAGH,GAAG,CAACO,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAT;AACD,GAXkC,CAYnC;;;AACA,MAAI;AACF,QAAMC,OAAO,GAAGf,GAAG,CAACgB,MAAJ,CAAWR,MAAX,EAAmB,+BAAnB,CAAhB;AAEAH,IAAAA,GAAG,CAACY,SAAJ,GAAgBjB,GAAG,CAACkB,MAAJ,CAAWV,MAAX,CAAhB;AACAH,IAAAA,GAAG,CAACU,OAAJ,GAAcA,OAAd;AACD,GALD,CAKE,OAAOI,GAAP,EAAY;AACZ,WAAOb,GAAG,CAACc,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqBnB,SAAS,CAACoB,KAAV,CAAgB,6BAAhB,CAArB,CAAP;AACD;;AAED,SAAOf,IAAI,EAAX;AACD,CAvBD","sourcesContent":["const jwt = require('jsonwebtoken');\n// eslint-disable-next-line no-underscore-dangle\nconst _response = require('../helpers/response');\n\nmodule.exports = (req, res, next) => {\n  let rtoken;\n  if (req.body.token) {\n    const [token] = req.body;\n    rtoken = token;\n  } else if (req.param.token) {\n    const [token] = res.param;\n    rtoken = token;\n  } else if (req.headers.authorization) {\n    // eslint-disable-next-line prefer-destructuring\n    rtoken = req.headers.authorization.split(' ')[1];\n  }\n  // check if an authtorization headeer exixsts\n  try {\n    const decoded = jwt.verify(rtoken, 'p2456653RDFBNYH2R31324354YT43');\n\n    req.usertoken = jwt.decode(rtoken);\n    req.decoded = decoded;\n  } catch (err) {\n    return res.status(401).json(_response.error('Token Authentication Failed'));\n  }\n\n  return next();\n};\n"],"file":"auth_check.js"}