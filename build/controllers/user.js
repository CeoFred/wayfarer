"use strict";

/* eslint-disable consistent-return */

/* eslint-disable no-underscore-dangle */
var express = require('express');

var router = express.Router();

var logger = require('logger').createLogger('./development.log');

var bcrypt = require('bcrypt');

var _require = require('express-validator'),
    check = _require.check,
    validationResult = _require.validationResult,
    body = _require.body;

var _require2 = require('express-validator'),
    sanitizeBody = _require2.sanitizeBody;

var _response = require('../helpers/response');

var db = require('../config/db');

var Utils = require('../helpers/utils');

var authCheck = require('../middlewares/auth_check'); // create a new user


router.post('/signup', [check('email').exists().withMessage('Email is required'), check('password').exists().withMessage('Password is required'), check('first_name').exists().withMessage('First name is required'), check('last_name').exists().withMessage('Last name is required'), body('email').not().isEmpty().escape().isEmail(), sanitizeBody('email').normalizeEmail().trim()], function (req, res) {
  var errors = validationResult(req);

  if (!errors.isEmpty()) {
    res.status(404).json(_response.error(errors));
  } // logger.info({ errors, msg: 'User auth validation' });


  var _req$body = req.body,
      email = _req$body.email,
      password = _req$body.password,
      first_name = _req$body.first_name,
      last_name = _req$body.last_name;
  var isAdmin = true;
  var searchQuery = "SELECT * FROM users WHERE email = '".concat(email, "' ");
  db.query(searchQuery).then(function (resp) {
    if (resp.rowCount > 0) {
      res.status(403).json(_response.error('Email already exists'));
    } else {
      // find users
      db.query('SELECT * FROM users').then(function (users) {
        if (users.rowCount > 0) {
          isAdmin = false;
        }

        bcrypt.hash(password ? password.toLowerCase() : null, 10, function (err, hash) {
          if (err) {
            res.status(500).json(_response.error(err));
          } else {
            var uniqui = Utils.randomString(200);
            var query = {
              text: 'INSERT INTO users(user_id,first_name,last_name,email,password,is_admin,address) VALUES($1,$2,$3,$4,$5,$6,$7) RETURNING *',
              values: [uniqui.trimRight(), first_name, last_name, email, hash, isAdmin, 'somewhere']
            };
            db.query(query).then(function (respo) {
              var jwtdata = {
                email: respo.rows[0].email,
                user_id: respo.rows[0].user_id,
                is_admin: respo.rows[0].is_admin,
                id: respo.rows[0].user_id
              };
              var token = Utils.signToken(jwtdata);
              var data = {
                user_id: respo.rows[0].user_id,
                is_admin: respo.rows[0].is_admin,
                id: respo.rows[0].user_id,
                token: token
              };
              console.log("Created ".concat(JSON.stringify(data)));
              res.status(201).json(_response.success(data));
            })["catch"](function (e) {
              logger.error(e);
              res.status(500).json(_response.error('Something went wrong'));
            });
          }
        }); // logger.info(isAdmin);
      })["catch"](function (err) {
        logger.error(err);
        res.status(505).json(_response.error('Could not fetch users'));
      }); // end find users
    }
  })["catch"](function (err) {
    res.json(_response.error(err));
  }); // res.send(response.error('Something went wrong'))
}).post('/signin', [body('email').not().isEmpty().escape().isEmail(), body('password').not().isEmpty(), check('email').exists().withMessage('Email is required'), check('password').exists().withMessage('Password is required')], function (req, res) {
  var errors = validationResult(req);

  if (!errors.isEmpty()) {
    return res.status(403).send(_response.error(errors));
  }

  var _req$body2 = req.body,
      email = _req$body2.email,
      password = _req$body2.password;
  var searchQuery = "SELECT * FROM users WHERE email = '".concat(email.toLowerCase(), "'");
  db.query(searchQuery).then(function (resp) {
    if (resp.rowCount <= 0) {
      console.log("Email does not exist,check ".concat(email));
      res.status(402).json(_response.error('Email does not exist'));
    } // logger.info(`User ${resp.rows}`);


    bcrypt.compare(password ? password.toLowerCase() : null, resp.rows[0].password).then(function () {
      var jwtdata = {
        email: resp.rows[0].email,
        user_id: resp.rows[0].user_id,
        is_admin: resp.rows[0].is_admin,
        id: resp.rows[0].user_id
      };
      var token = Utils.signToken(jwtdata);
      req.headers.authorization = "Bearer ".concat(token);
      var data = {
        user_id: resp.rows[0].user_id,
        is_admin: resp.rows[0].is_admin,
        id: resp.rows[0].user_id,
        token: token
      };
      res.status(200).json(_response.success(data));
    })["catch"](function (err) {
      logger.error("Bycrypt error ".concat(err));
      res.status(500).json(_response.error('Failed to compare passwords'));
    });
  });
}).post('/admin/:user_id', authCheck, function (req, res) {
  // make user an admin
  var toBeAdmin = req.params.user_id;
  var data = req.decoded.data;
  var admin = data.is_admin; // logger.info(admin);

  if (admin) {
    db.query("SELECT * FROM users WHERE user_id = '".concat(toBeAdmin, "' AND is_admin='", false, "'")).then(function (resp) {
      if (resp.rowCount > 0) {
        db.query("UPDATE users SET is_admin='".concat(true, "' WHERE user_id = '", toBeAdmin, "' RETURNING *")).then(function (newAdminData) {
          if (newAdminData.rowCount > 0) {
            res.status(200).json(_response.success(newAdminData.rows[0]));
          } else {
            res.status(500).json(_response.error('Failed to assign role'));
          }
        })["catch"](function () {
          res.status(401).json(_response.error('Opps! Something went wrong'));
        });
      } else {
        res.status(403).json(_response.error('Cannot re-assign role to user'));
      }
    })["catch"](function () {
      res.status(401).json(_response.error('Opps! Something went wrong'));
    });
  } else {
    res.status(505).json(_response.error('Your plans failed, we have a stronger algorithm'));
  }
});
module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2FwcC9jb250cm9sbGVycy91c2VyLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwibG9nZ2VyIiwiY3JlYXRlTG9nZ2VyIiwiYmNyeXB0IiwiY2hlY2siLCJ2YWxpZGF0aW9uUmVzdWx0IiwiYm9keSIsInNhbml0aXplQm9keSIsIl9yZXNwb25zZSIsImRiIiwiVXRpbHMiLCJhdXRoQ2hlY2siLCJwb3N0IiwiZXhpc3RzIiwid2l0aE1lc3NhZ2UiLCJub3QiLCJpc0VtcHR5IiwiZXNjYXBlIiwiaXNFbWFpbCIsIm5vcm1hbGl6ZUVtYWlsIiwidHJpbSIsInJlcSIsInJlcyIsImVycm9ycyIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImVtYWlsIiwicGFzc3dvcmQiLCJmaXJzdF9uYW1lIiwibGFzdF9uYW1lIiwiaXNBZG1pbiIsInNlYXJjaFF1ZXJ5IiwicXVlcnkiLCJ0aGVuIiwicmVzcCIsInJvd0NvdW50IiwidXNlcnMiLCJoYXNoIiwidG9Mb3dlckNhc2UiLCJlcnIiLCJ1bmlxdWkiLCJyYW5kb21TdHJpbmciLCJ0ZXh0IiwidmFsdWVzIiwidHJpbVJpZ2h0IiwicmVzcG8iLCJqd3RkYXRhIiwicm93cyIsInVzZXJfaWQiLCJpc19hZG1pbiIsImlkIiwidG9rZW4iLCJzaWduVG9rZW4iLCJkYXRhIiwiY29uc29sZSIsImxvZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdWNjZXNzIiwiZSIsInNlbmQiLCJjb21wYXJlIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0b0JlQWRtaW4iLCJwYXJhbXMiLCJkZWNvZGVkIiwiYWRtaW4iLCJuZXdBZG1pbkRhdGEiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBO0FBQ0EsSUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBRCxDQUF2Qjs7QUFFQSxJQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBUixFQUFm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QUNELFdBRkQsTUFFTztBQUNMMUIsWUFBQUEsR0FBRyxDQUFDRSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJqQixTQUFTLENBQUNrQixLQUFWLENBQWdCLHVCQUFoQixDQUFyQjtBQUNEO0FBQ0YsU0FORCxXQU1TLFlBQU07QUFDYkosVUFBQUEsR0FBRyxDQUFDRSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJqQixTQUFTLENBQUNrQixLQUFWLENBQWdCLDRCQUFoQixDQUFyQjtBQUNELFNBUkQ7QUFTRCxPQVZELE1BVU87QUFDTEosUUFBQUEsR0FBRyxDQUFDRSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJqQixTQUFTLENBQUNrQixLQUFWLENBQWdCLCtCQUFoQixDQUFyQjtBQUNEO0FBQ0YsS0FkRCxXQWNTLFlBQU07QUFDYkosTUFBQUEsR0FBRyxDQUFDRSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJqQixTQUFTLENBQUNrQixLQUFWLENBQWdCLDRCQUFoQixDQUFyQjtBQUNELEtBaEJEO0FBaUJELEdBbEJELE1Ba0JPO0FBQ0xKLElBQUFBLEdBQUcsQ0FBQ0UsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCakIsU0FBUyxDQUFDa0IsS0FBVixDQUFnQixpREFBaEIsQ0FBckI7QUFDRDtBQUNGLENBdEpEO0FBd0pBNEMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCeEUsTUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBjb25zaXN0ZW50LXJldHVybiAqL1xuLyogZXNsaW50LWRpc2FibGUgbm8tdW5kZXJzY29yZS1kYW5nbGUgKi9cbmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5cbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBsb2dnZXIgPSByZXF1aXJlKCdsb2dnZXInKS5jcmVhdGVMb2dnZXIoJy4vZGV2ZWxvcG1lbnQubG9nJyk7XG5cblxuY29uc3QgYmNyeXB0ID0gcmVxdWlyZSgnYmNyeXB0Jyk7XG5jb25zdCB7XG4gIGNoZWNrLFxuICB2YWxpZGF0aW9uUmVzdWx0LCBib2R5LFxufSA9IHJlcXVpcmUoJ2V4cHJlc3MtdmFsaWRhdG9yJyk7XG5cbmNvbnN0IHtcbiAgc2FuaXRpemVCb2R5LFxufSA9IHJlcXVpcmUoJ2V4cHJlc3MtdmFsaWRhdG9yJyk7XG5jb25zdCBfcmVzcG9uc2UgPSByZXF1aXJlKCcuLi9oZWxwZXJzL3Jlc3BvbnNlJyk7XG5jb25zdCBkYiA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYicpO1xuY29uc3QgVXRpbHMgPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWxzJyk7XG5jb25zdCBhdXRoQ2hlY2sgPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlcy9hdXRoX2NoZWNrJyk7XG5cbi8vIGNyZWF0ZSBhIG5ldyB1c2VyXG5yb3V0ZXIucG9zdCgnL3NpZ251cCcsXG4gIFtcbiAgICBjaGVjaygnZW1haWwnKS5leGlzdHMoKS53aXRoTWVzc2FnZSgnRW1haWwgaXMgcmVxdWlyZWQnKSxcbiAgICBjaGVjaygncGFzc3dvcmQnKS5leGlzdHMoKS53aXRoTWVzc2FnZSgnUGFzc3dvcmQgaXMgcmVxdWlyZWQnKSxcbiAgICBjaGVjaygnZmlyc3RfbmFtZScpLmV4aXN0cygpLndpdGhNZXNzYWdlKCdGaXJzdCBuYW1lIGlzIHJlcXVpcmVkJyksXG4gICAgY2hlY2soJ2xhc3RfbmFtZScpLmV4aXN0cygpLndpdGhNZXNzYWdlKCdMYXN0IG5hbWUgaXMgcmVxdWlyZWQnKSxcbiAgICBib2R5KCdlbWFpbCcpLm5vdCgpLmlzRW1wdHkoKS5lc2NhcGUoKVxuICAgICAgLmlzRW1haWwoKSxcbiAgICBzYW5pdGl6ZUJvZHkoJ2VtYWlsJykubm9ybWFsaXplRW1haWwoKS50cmltKCksXG4gIF0sIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRpb25SZXN1bHQocmVxKTtcbiAgICBpZiAoIWVycm9ycy5pc0VtcHR5KCkpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKF9yZXNwb25zZS5lcnJvcihlcnJvcnMpKTtcbiAgICB9XG4gICAgLy8gbG9nZ2VyLmluZm8oeyBlcnJvcnMsIG1zZzogJ1VzZXIgYXV0aCB2YWxpZGF0aW9uJyB9KTtcbiAgICBjb25zdCB7XG4gICAgICBlbWFpbCxcbiAgICAgIHBhc3N3b3JkLFxuICAgICAgZmlyc3RfbmFtZSxcbiAgICAgIGxhc3RfbmFtZSxcbiAgICB9ID0gcmVxLmJvZHk7XG4gICAgbGV0IGlzQWRtaW4gPSB0cnVlO1xuICAgIGNvbnN0IHNlYXJjaFF1ZXJ5ID0gYFNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgZW1haWwgPSAnJHtlbWFpbH0nIGA7XG5cbiAgICBkYi5xdWVyeShzZWFyY2hRdWVyeSkudGhlbigocmVzcCkgPT4ge1xuICAgICAgaWYgKHJlc3Aucm93Q291bnQgPiAwKSB7XG4gICAgICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKF9yZXNwb25zZS5lcnJvcignRW1haWwgYWxyZWFkeSBleGlzdHMnKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBmaW5kIHVzZXJzXG4gICAgICAgIGRiLnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzZXJzJykudGhlbigodXNlcnMpID0+IHtcbiAgICAgICAgICBpZiAodXNlcnMucm93Q291bnQgPiAwKSB7XG4gICAgICAgICAgICBpc0FkbWluID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJjcnlwdC5oYXNoKHBhc3N3b3JkID8gcGFzc3dvcmQudG9Mb3dlckNhc2UoKSA6IG51bGwsIDEwLCAoZXJyLCBoYXNoKSA9PiB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKF9yZXNwb25zZS5lcnJvcihlcnIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnN0IHVuaXF1aSA9IFV0aWxzLnJhbmRvbVN0cmluZygyMDApO1xuICAgICAgICAgICAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgICAgICAgICAgICB0ZXh0OiAnSU5TRVJUIElOVE8gdXNlcnModXNlcl9pZCxmaXJzdF9uYW1lLGxhc3RfbmFtZSxlbWFpbCxwYXNzd29yZCxpc19hZG1pbixhZGRyZXNzKSBWQUxVRVMoJDEsJDIsJDMsJDQsJDUsJDYsJDcpIFJFVFVSTklORyAqJyxcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IFt1bmlxdWkudHJpbVJpZ2h0KCksIGZpcnN0X25hbWUsIGxhc3RfbmFtZSwgZW1haWwsIGhhc2gsIGlzQWRtaW4sICdzb21ld2hlcmUnXSxcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgZGIucXVlcnkocXVlcnkpXG4gICAgICAgICAgICAgICAgLnRoZW4oKHJlc3BvKSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBqd3RkYXRhID0ge1xuICAgICAgICAgICAgICAgICAgICBlbWFpbDogcmVzcG8ucm93c1swXS5lbWFpbCxcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogcmVzcG8ucm93c1swXS51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgICBpc19hZG1pbjogcmVzcG8ucm93c1swXS5pc19hZG1pbixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHJlc3BvLnJvd3NbMF0udXNlcl9pZCxcblxuICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gVXRpbHMuc2lnblRva2VuKGp3dGRhdGEpO1xuICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcl9pZDogcmVzcG8ucm93c1swXS51c2VyX2lkLFxuICAgICAgICAgICAgICAgICAgICBpc19hZG1pbjogcmVzcG8ucm93c1swXS5pc19hZG1pbixcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHJlc3BvLnJvd3NbMF0udXNlcl9pZCxcbiAgICAgICAgICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYENyZWF0ZWQgJHtKU09OLnN0cmluZ2lmeShkYXRhKX1gKTtcbiAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKF9yZXNwb25zZS5zdWNjZXNzKGRhdGEpKTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgbG9nZ2VyLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oX3Jlc3BvbnNlLmVycm9yKCdTb21ldGhpbmcgd2VudCB3cm9uZycpKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgICAvLyBsb2dnZXIuaW5mbyhpc0FkbWluKTtcbiAgICAgICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihlcnIpO1xuICAgICAgICAgIHJlcy5zdGF0dXMoNTA1KS5qc29uKF9yZXNwb25zZS5lcnJvcignQ291bGQgbm90IGZldGNoIHVzZXJzJykpO1xuICAgICAgICB9KTtcbiAgICAgICAgLy8gZW5kIGZpbmQgdXNlcnNcbiAgICAgIH1cbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICByZXMuanNvbihfcmVzcG9uc2UuZXJyb3IoZXJyKSk7XG4gICAgfSk7XG5cblxuICAgIC8vIHJlcy5zZW5kKHJlc3BvbnNlLmVycm9yKCdTb21ldGhpbmcgd2VudCB3cm9uZycpKVxuICB9KS5wb3N0KCcvc2lnbmluJywgW2JvZHkoJ2VtYWlsJykubm90KCkuaXNFbXB0eSgpLmVzY2FwZSgpXG4gIC5pc0VtYWlsKCksXG5ib2R5KCdwYXNzd29yZCcpLm5vdCgpLmlzRW1wdHkoKSxcbmNoZWNrKCdlbWFpbCcpLmV4aXN0cygpLndpdGhNZXNzYWdlKCdFbWFpbCBpcyByZXF1aXJlZCcpLFxuY2hlY2soJ3Bhc3N3b3JkJykuZXhpc3RzKCkud2l0aE1lc3NhZ2UoJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJyldLFxuKHJlcSwgcmVzKSA9PiB7XG4gIGNvbnN0IGVycm9ycyA9IHZhbGlkYXRpb25SZXN1bHQocmVxKTtcbiAgaWYgKCFlcnJvcnMuaXNFbXB0eSgpKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKF9yZXNwb25zZS5lcnJvcihlcnJvcnMpKTtcbiAgfVxuICBjb25zdCB7XG4gICAgZW1haWwsXG4gICAgcGFzc3dvcmQsXG4gIH0gPSByZXEuYm9keTtcbiAgY29uc3Qgc2VhcmNoUXVlcnkgPSBgU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBlbWFpbCA9ICcke2VtYWlsLnRvTG93ZXJDYXNlKCl9J2A7XG5cbiAgZGIucXVlcnkoc2VhcmNoUXVlcnkpLnRoZW4oKHJlc3ApID0+IHtcbiAgICBpZiAocmVzcC5yb3dDb3VudCA8PSAwKSB7XG4gICAgICBjb25zb2xlLmxvZyhgRW1haWwgZG9lcyBub3QgZXhpc3QsY2hlY2sgJHtlbWFpbH1gKTtcbiAgICAgIHJlcy5zdGF0dXMoNDAyKS5qc29uKF9yZXNwb25zZS5lcnJvcignRW1haWwgZG9lcyBub3QgZXhpc3QnKSk7XG4gICAgfVxuICAgIC8vIGxvZ2dlci5pbmZvKGBVc2VyICR7cmVzcC5yb3dzfWApO1xuICAgIGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkID8gcGFzc3dvcmQudG9Mb3dlckNhc2UoKSA6IG51bGwsIHJlc3Aucm93c1swXS5wYXNzd29yZCkudGhlbigoKSA9PiB7XG4gICAgICBjb25zdCBqd3RkYXRhID0ge1xuICAgICAgICBlbWFpbDogcmVzcC5yb3dzWzBdLmVtYWlsLFxuICAgICAgICB1c2VyX2lkOiByZXNwLnJvd3NbMF0udXNlcl9pZCxcbiAgICAgICAgaXNfYWRtaW46IHJlc3Aucm93c1swXS5pc19hZG1pbixcbiAgICAgICAgaWQ6IHJlc3Aucm93c1swXS51c2VyX2lkLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHRva2VuID0gVXRpbHMuc2lnblRva2VuKGp3dGRhdGEpO1xuICAgICAgcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbiA9IGBCZWFyZXIgJHt0b2tlbn1gO1xuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgdXNlcl9pZDogcmVzcC5yb3dzWzBdLnVzZXJfaWQsXG4gICAgICAgIGlzX2FkbWluOiByZXNwLnJvd3NbMF0uaXNfYWRtaW4sXG4gICAgICAgIGlkOiByZXNwLnJvd3NbMF0udXNlcl9pZCxcbiAgICAgICAgdG9rZW4sXG4gICAgICB9O1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oX3Jlc3BvbnNlLnN1Y2Nlc3MoZGF0YSkpO1xuICAgIH0pLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGxvZ2dlci5lcnJvcihgQnljcnlwdCBlcnJvciAke2Vycn1gKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKF9yZXNwb25zZS5lcnJvcignRmFpbGVkIHRvIGNvbXBhcmUgcGFzc3dvcmRzJykpO1xuICAgIH0pO1xuICB9KTtcbn0pLnBvc3QoJy9hZG1pbi86dXNlcl9pZCcsIGF1dGhDaGVjaywgKHJlcSwgcmVzKSA9PiB7XG4gIC8vIG1ha2UgdXNlciBhbiBhZG1pblxuICBjb25zdCB0b0JlQWRtaW4gPSByZXEucGFyYW1zLnVzZXJfaWQ7XG4gIGNvbnN0IHsgZGF0YSB9ID0gcmVxLmRlY29kZWQ7XG4gIGNvbnN0IGFkbWluID0gZGF0YS5pc19hZG1pbjtcblxuICAvLyBsb2dnZXIuaW5mbyhhZG1pbik7XG4gIGlmIChhZG1pbikge1xuICAgIGRiLnF1ZXJ5KGBTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJfaWQgPSAnJHt0b0JlQWRtaW59JyBBTkQgaXNfYWRtaW49JyR7ZmFsc2V9J2ApLnRoZW4oKHJlc3ApID0+IHtcbiAgICAgIGlmIChyZXNwLnJvd0NvdW50ID4gMCkge1xuICAgICAgICBkYi5xdWVyeShgVVBEQVRFIHVzZXJzIFNFVCBpc19hZG1pbj0nJHt0cnVlfScgV0hFUkUgdXNlcl9pZCA9ICcke3RvQmVBZG1pbn0nIFJFVFVSTklORyAqYCkudGhlbigobmV3QWRtaW5EYXRhKSA9PiB7XG4gICAgICAgICAgaWYgKG5ld0FkbWluRGF0YS5yb3dDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKF9yZXNwb25zZS5zdWNjZXNzKG5ld0FkbWluRGF0YS5yb3dzWzBdKSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKF9yZXNwb25zZS5lcnJvcignRmFpbGVkIHRvIGFzc2lnbiByb2xlJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xuICAgICAgICAgIHJlcy5zdGF0dXMoNDAxKS5qc29uKF9yZXNwb25zZS5lcnJvcignT3BwcyEgU29tZXRoaW5nIHdlbnQgd3JvbmcnKSk7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDMpLmpzb24oX3Jlc3BvbnNlLmVycm9yKCdDYW5ub3QgcmUtYXNzaWduIHJvbGUgdG8gdXNlcicpKTtcbiAgICAgIH1cbiAgICB9KS5jYXRjaCgoKSA9PiB7XG4gICAgICByZXMuc3RhdHVzKDQwMSkuanNvbihfcmVzcG9uc2UuZXJyb3IoJ09wcHMhIFNvbWV0aGluZyB3ZW50IHdyb25nJykpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJlcy5zdGF0dXMoNTA1KS5qc29uKF9yZXNwb25zZS5lcnJvcignWW91ciBwbGFucyBmYWlsZWQsIHdlIGhhdmUgYSBzdHJvbmdlciBhbGdvcml0aG0nKSk7XG4gIH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdfQ==