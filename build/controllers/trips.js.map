{"version":3,"sources":["../../app/controllers/trips.js"],"names":["express","require","router","Router","response","db","Utils","authCheck","post","req","res","body","busId","origin","destination","fare","tripDate","departureTime","data","decoded","is_admin","status","json","error","uniqui","randomString","query","text","values","userId","trimRight","then","resp","success","rows","err","get","module","exports"],"mappings":"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","sourcesContent":["const express = require('express');\n\nconst router = express.Router();\nconst response = require('../helpers/response');\nconst db = require('../config/db');\nconst Utils = require('../helpers/utils');\n\nconst authCheck = require('../middlewares/auth_check');\n\nrouter.post('/', authCheck, (req, res) => {\n// new trip\n  const {\n    busId,\n    origin,\n    destination,\n    fare,\n    tripDate,\n    departureTime,\n\n  } = req.body;\n  const { data } = req.decoded;\n  if (!data.is_admin) {\n    res.status(401).json(response.error('Access Denied'));\n  }\n\n  const uniqui = Utils.randomString(200);\n\n  const query = {\n    text: 'INSERT INTO trips(user_id,bus_id,origin,destination,trip_date,fare,departure_time,trip_id,status) VALUES($1,$2,$3,$4,$5,$6,$7,$8,$9) RETURNING *',\n    values: [data.userId, busId, origin, destination, tripDate, fare, departureTime, uniqui.trimRight(), 'Active'],\n  };\n\n  db.query(query).then((resp) => {\n    res.status(201).json(response.success(resp.rows[0]));\n  }).catch((err) => {\n    res.status(500).json(response.error(err));\n    throw err;\n  });\n\n// res.json({})\n}).post('/cancle/:trip_id', (req, res) => {\n\n\n}).get('/', (req, res) => {\n  // get all trips available\n  db.query(\"SELECT * FROM trips WHERE status = 'Active' \").then((resp) => {\n    res.status(200).json(response.success(resp.rows));\n  }).catch((err) => {\n    res.status(500).json(response.error('Failed to fetch trips'));\n    throw err;\n  });\n}).get('/all/f/:origin', (req, res) => {\n\n})\n  .get('/all/f/:destination', (req, res) => {\n\n  });\n\nmodule.exports = router;\n"],"file":"trips.js"}